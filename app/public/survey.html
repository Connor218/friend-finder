<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Reservation Page</title>

  <!-- Latest compiled and minified CSS & JS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <style>
    .error, .error p {
          color: red;
      }
      .error:before {
          content: "* "
      }
      img {
        max-width: 100%;
      }
  </style>

</head>
<body>

  <div class="container">

    <div class="jumbotron">
      <h1 class="text-center"><span></span>Friend Finder</h1>
      <hr>
      <h2 class="text-center">Find a Friend!</h2>
      <br>

      <div class="text-center">
        <a href="/api/friends"><button class="btn btn-lg btn-primary"><span class="fa fa-list-alt"></span> View Tables</button></a>
        <a href="/"><button class="btn btn-lg btn-default"><span class="fa fa-home"></span></button></a>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-12">

        <!-- Reservation Page -->
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">Survey</h4>
          </div>
          <div class="panel-body">

            <form role="form">

              <div class="form-group">
                <p for="friend-name">Name</p>
                <input type="text" class="form-control" id="friend-name">
              </div>

              <div class="form-group">
                <p for="friend-image" id="image-label">Image</p>
                <input type="text" class="form-control" id="friend-image">
              </div>

              <div class="questions">
                <p>q 1</p>
               
                  <input class="options" type="radio" name="q1"  value="1"> Active
                  <input class="options" type="radio" name="q1"   value="2"> Radio
                  <input class="options" type="radio" name="q1"   value="3"> Radio
                  <input class="options" type="radio" name="q1"  value="4"> Radio
                  <input class="options" type="radio" name="q1"  value="5"> Radio
                
              </div>
              <br>
              <br>
              <div class="questions">
                <p>q 2</p>
               
                  <input class="options" type="radio" name="q2"  value="1"> Active
                  <input class="options" type="radio" name="q2"  value="1"> Radio
                  <input class="options" type="radio" name="q2" value="1"> Radio
                  <input class="options" type="radio" name="q2"  value="1"> Radio
                  <input class="options" type="radio" name="q2"  value="1"> Radio
                
              </div>
              <br>
              <br>
              <div class="questions">
                <p>q 3</p>
               
                  <input class="options" type="radio" name="q3"  value="1"> Active
                  <input class="options" type="radio" name="q3"  value="1"> Radio
                  <input class="options" type="radio" name="q3" value="1"> Radio
                  <input class="options" type="radio" name="q3"  value="1"> Radio
                  <input class="options" type="radio" name="q3"  value="1"> Radio
                
              </div>
              <br>
              <br>
              <div class="questions">
                <p>q 4</p>
               
                  <input class="options" type="radio" name="q4"  value="1"> Active
                  <input class="options" type="radio" name="q4"  value="1"> Radio
                  <input class="options" type="radio" name="q4" value="1"> Radio
                  <input class="options" type="radio" name="q4"  value="1"> Radio
                  <input class="options" type="radio" name="q4"  value="1"> Radio
                
              </div>
              <br>
              <br>
              <div class="questions">
                <p>q 5</p>
               
                  <input class="options" type="radio" name="q5"  value="1"> Active
                  <input class="options" type="radio" name="q5"  value="1"> Radio
                  <input class="options" type="radio" name="q5" value="1"> Radio
                  <input class="options" type="radio" name="q5"  value="1"> Radio
                  <input class="options" type="radio" name="q5"  value="1"> Radio
                
              </div>
              <br>
              <br>
              <div class="questions">
                <p>q 6</p>
               
                  <input class="options" type="radio" name="q6"  value="1"> Active
                  <input class="options" type="radio" name="q6"  value="1"> Radio
                  <input class="options" type="radio" name="q6" value="1"> Radio
                  <input class="options" type="radio" name="q6"  value="1"> Radio
                  <input class="options" type="radio" name="q6"  value="1"> Radio
                
              </div>
              <br>
              <br>
              <div class="questions">
                <p>q 7</p>
               
                  <input class="options" type="radio" name="q7"  value="1"> Active
                  <input class="options" type="radio" name="q7"  value="1"> Radio
                  <input class="options" type="radio" name="q7" value="1"> Radio
                  <input class="options" type="radio" name="q7"  value="1"> Radio
                  <input class="options" type="radio" name="q7"  value="1"> Radio
                
              </div>
              <br>
              <br>
              <div class="questions">
                <p>q 8</p>
               
                  <input class="options" type="radio" name="q8"  value="1"> Active
                  <input class="options" type="radio" name="q8"  value="1"> Radio
                  <input class="options" type="radio" name="q8" value="1"> Radio
                  <input class="options" type="radio" name="q8"  value="1"> Radio
                  <input class="options" type="radio" name="q8"  value="1"> Radio
                
              </div>
              <br>
              <br>
              <div class="questions">
                <p>q 9</p>
               
                  <input class="options" type="radio" name="q9"  value="1"> Active
                  <input class="options" type="radio" name="q9"  value="1"> Radio
                  <input class="options" type="radio" name="q9" value="1"> Radio
                  <input class="options" type="radio" name="q9"  value="1"> Radio
                  <input class="options" type="radio" name="q9"  value="1"> Radio
                
              </div>
              <br>
              <br>
              <div class="questions">
                <p>q 10</p>
               
                  <input class="options" type="radio" name="q10"  value="1"> Active
                  <input class="options" type="radio" name="q10"  value="1"> Radio
                  <input class="options" type="radio" name="q10" value="1"> Radio
                  <input class="options" type="radio" name="q10"  value="1"> Radio
                  <input class="options" type="radio" name="q10"  value="1"> Radio
                
              </div>
              <br>
              <br>
              <button type="submit" class="btn btn-primary submit" id="submit">Submit</button>
            </form>

          </div>
        </div>

      </div>
    </div>


    <footer class="footer">
      <div class="container">
        <p><a href="/api/tables">API Table Link</a> | <a href="/api/waitlist">API Wait List</a> </p>
      </div>
    </footer>

  </div>

<!-- Modal -->
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          
        </div>
      </div>
    </div>
  </div>


  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  <script>
    $(function(){
      $("#submit").on("click", function(e){
        e.preventDefault();
        var newFriend = {
          name: $("#friend-name").val().trim(),
          photo: $("#friend-image").val().trim(),
          scores: []
        }

        getValues(newFriend.scores);

        var isURl = validateURL(newFriend.photo);

        if(isURl && newFriend.name.length > 0 && newFriend.scores.length === 10){
          
          $(".modal-body").empty();
          
          var loader = $("<img>").attr("src", "https://vignette.wikia.nocookie.net/nyancat/images/e/e7/Nyancat.gif/revision/latest?cb=20130808073427");
          var loadingMsg = $("<h3>").text("Loading your perfct match");
          $(".modal-body").append(loader, loadingMsg);
          $("#modal").modal("show");
          // set timeout
          setTimeout(function(){
            $.post("/api/friends", newFriend, function(match){
            console.log(match);
            // the new match
            $(".modal-body").empty();

            var msg = $("<h3>").text("Your Match is:");
            var matchName = $("<h3>").text(match.name);
            var matchPhoto =$("<img>").attr("src", match.photo).attr("alt", "match image");
            $(".modal-body").append(msg, matchName, matchPhoto);

            $("#modal").modal("show");

            $(".options").each(function(){
              $(this).attr('checked',false).val('');
            });

            $("#friend-name").val("");
            $("#friend-image").val("");

          });
          }, 3000);
        }else {
          $(".modal-body").empty();
          var msg = $("<h3>").text("please complet the entire form");
          $(".modal-body").append(msg);

          $("#modal").modal("show");
        }

      });
      
      function validateURL(url){
            var urlPattern = /(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/;
            if(!urlPattern.test(url)) {
               $("#image-label").addClass("error");
                //console.log(false)
                return false;
            } else {
                $("#image-label").removeClass("error");
                //console.log(true)
                return true;
            }
        }

      function getValues(scores){
            $(".questions").each(function(){
                if($(this).find("input:radio:checked").length) {
                    $(this).removeClass("error");
                    // console.log("val",$(this).find("input:radio:checked").val());
                    var answer = parseInt($(this).find("input:radio:checked").val());
                    scores.push(answer);

                }
                else {
                    $(this).addClass("error");
                }
            });
        }
    });
  </script>
</body>
</html>